<!doctype html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>Database Excel</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body { font-family: Arial, sans-serif; margin: 2rem; }
    input { margin-bottom: 1rem; padding: .5rem; width: 100%; max-width: 400px; }
    table { border-collapse: collapse; width: 100%; }
    th, td { border: 1px solid #ccc; padding: .5rem; text-align: left; }
    th { background: #f2f2f2; cursor: pointer; }
  </style>
</head>
<body>

  <h1>Database Excel</h1>
  <input id="searchBox" type="text" placeholder="Cari dataâ€¦" />
  <table id="dataTable">
    <thead id="tableHead"></thead>
    <tbody id="tableBody"></tbody>
  </table>

  <!-- SheetJS CDN -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

  <script>
    const EXCEL_URL = 'https://raw.githubusercontent.com/andricris/databseall/main/data.xlsx';

    fetch(EXCEL_URL)
      .then(res => res.arrayBuffer())
      .then(ab => {
        const wb = XLSX.read(ab, { type: 'array' });
        const ws = wb.Sheets[wb.SheetNames[0]];
        const data = XLSX.utils.sheet_to_json(ws, { header: 1 }); // array of arrays
        renderTable(data);
      })
      .catch(err => {
        document.body.innerHTML = '<p>Gagal memuat file Excel. Pastikan file <b>data.xlsx</b> sudah di-upload ke repo.</p>';
        console.error(err);
      });

    function renderTable(data) {
      if (!data.length) return;
      const head = data[0];
      const rows = data.slice(1);

      // header
      const headRow = head.map(h => `<th>${h}</th>`).join('');
      document.getElementById('tableHead').innerHTML = `<tr>${headRow}</tr>`;

      // body
      const bodyHtml = rows.map(r => {
        const cells = r.map(c => `<td>${c ?? ''}</td>`).join('');
        return `<tr>${cells}</tr>`;
      }).join('');
      document.getElementById('tableBody').innerHTML = bodyHtml;

      // search
      document.getElementById('searchBox').addEventListener('input', e => {
        const kw = e.target.value.toLowerCase();
        [...document.getElementById('tableBody').rows].forEach(row => {
          const match = [...row.cells].some(cell =>
            cell.textContent.toLowerCase().includes(kw)
          );
          row.style.display = match ? '' : 'none';
        });
      });
    }
  </script>

</body>
</html>
