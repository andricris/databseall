<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8"/>
  <title>Database Excel Repo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <style>
    body{font-family:Arial,Helvetica,sans-serif;margin:2rem;background:#f7f7f7}
    h1{color:#333}
    ul{list-style:none;padding:0}
    li{background:#fff;margin:.5rem 0;padding:.75rem 1rem;border-radius:4px;display:flex;justify-content:space-between;align-items:center;box-shadow:0 1px 3px rgba(0,0,0,.1)}
    a{text-decoration:none;color:#0066cc;font-weight:bold}
    a:hover{text-decoration:underline}
    .size{color:#666;font-size:.85rem}
    .loading,.error{color:#666}
    .error{color:#c00}
  </style>
</head>
<body>

  <h1>Daftar File Excel di Repository</h1>
  <p id="stat" class="loading">Memuat daftar fileâ€¦</p>
  <ul id="list"></ul>

  <script>
    const USER  = 'andricris';
    const REPO  = 'databseall';
    const API   = `https://api.github.com/repos/${USER}/${REPO}/contents`;

    fetch(API)
      .then(r => r.ok ? r.json() : Promise.reject(r.status))
      .then(files => {
        const excel = files.filter(f =>
          f.type==='file' &&
          /\.xlsx?$/i.test(f.name)
        );
        const list = document.getElementById('list');
        const stat = document.getElementById('stat');

        if (!excel.length) {
          stat.textContent = 'Belum ada file Excel di repo ini.';
          stat.className = 'error';
          return;
        }

        stat.style.display = 'none';
        excel.forEach(f => {
          const li = document.createElement('li');
          const dn = document.createElement('a');
          dn.href = f.download_url;
          dn.textContent = f.name;
          dn.download = f.name;

          const sz = document.createElement('span');
          sz.className = 'size';
          sz.textContent = formatBytes(f.size);

          li.appendChild(dn);
          li.appendChild(sz);
          list.appendChild(li);
        });
      })
      .catch(() => {
        document.getElementById('stat').textContent =
          'Gagal memuat daftar file; coba refresh atau periksa nama repo.';
        document.getElementById('stat').className = 'error';
      });

    function formatBytes(b){return b<1024?b+' B':(b/1024).toFixed(1)+' KB'}
  </script>

</body>
</html>
